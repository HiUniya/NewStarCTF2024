from gmpy2 import *
from Crypto.Util.number import *

n = 18104347461003907895610914021247683508445228187648940019610703551961828343286923443588324205257353157349226965840638901792059481287140055747874675375786201782262247550663098932351593199099796736521757473187142907551498526346132033381442243277945568526912391580431142769526917165011590824127172120180838162091
bits = 512
k1 = (2**512)-4
k1 = k1 * k1
print("p+q = ",k1)
k1 -= n*4
print("p-q = ",iroot(k1,2)[0])
k2 = iroot(k1,2)[0]
k1 = (2**512)-4

p = (k1+k2)//2
q = (k1-k2)//2
print("p = ",p)
print("q = ",q)


# |p-q| = 10361077339843379394678967475977773788465883947197722272612196001725971688948181929114936882669642813936998739129857379125425701054077358148129006015343690
# |p+q| = 179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474070746536173654477086980202226777861584201989800582511494874592375795286342587286005903043634569549639750557153552295743830922948468518555570595028199800836

# p =  11884442634892988247126496237091809957972624883895057825167878722723867859510864452958405590418273120813515298658171714989589791933011964047281327510713891
# q =  1523365295049608852447528761114036169506740936697335552555682720997896170562682523843468707748630306876516559528314335864164090878934605899152321495370201

print(p*q)

fi = (p-1)*(q-1)

e = 65537

c = 14859652090105683079145454585893160422247900801288656111826569181159038438427898859238993694117308678150258749913747829849091269373672489350727536945889312021893859587868138786640133976196803958879602927438349289325983895357127086714561807181967380062187404628829595784290171905916316214021661729616120643997

d = inverse(e,fi)

m = pow(c,d,n)

print(long_to_bytes(m))